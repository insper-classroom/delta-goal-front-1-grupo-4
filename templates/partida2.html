{% include 'header.html' %}


<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delta Goal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/partida.css') }}">
    <script src="{{ url_for('static', filename='js/video.js') }}"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <link rel="icon" href="{{ url_for('static', filename='img/delta_goal_logo.png') }}">
</head>
<body>
    
    
    <div class="main-container">
        <div class="left-container">
            <h3>Visão Geral</h3>
            <h4>Frequência nas sub-zonas</h4>
            <div class="campo-futebol">
                <div class="team-info left-team">
                    <img src="{{ url_for('static', filename='img/palmeiras.png') }}" alt="Logotipo Time Esquerda">
                    <span>SEP</span>
                </div>
                <div class="team-info right-team">
                    <span>RBB</span>
                    <img src="{{ url_for('static', filename='img/bragantino.png') }}" alt="Logotipo Time Direita">
                </div>
                <img src="static/img/campo.png" alt="Campo de Futebol">

                <div class="zona" id="D2-2" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagens.get('D2-2'.replace('-', '.'), '0.0') }}">
                    <p class="info">D2.2</p>
                </div>
                <div class="zona" id="D2-1" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagens.get('D2-1'.replace('-', '.'), '0.0') }}">
                    <p class="info">D2.1</p>
                </div>
                <div class="zona" id="D1-2" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagens.get('D1-2'.replace('-', '.'), '0.0') }}">
                    <p class="info">D1.2</p>
                </div>  
                <div class="zona" id="D3" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagens.get('D3'.replace('-', '.'), '0.00') }}">
                    <p class="info">D3</p>
                </div>
                <div class="zona" id="D1-1" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage= "{{ porcentagens.get('D1-1'.replace('-', '.'), '0.00') }}">
                    <p class="info">D1.1</p>
                </div>
                <div class="zona" id="E1-1" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagens.get('E1-1'.replace('-', '.'), '0.00') }}">
                    <p class="info">E1.1</p>
                </div>
                <div class="zona" id="E3" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagens.get('E3'.replace('-', '.'), '0.00') }}">
                    <p class="info">E3</p>
                </div>
                <div class="zona" id="E2-2" onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens.get('E2-2'.replace('-', '.'), '0.00') }}">
                    <p class="info">E2.2</p>
                </div>
                <div class="zona" id="E2-1" onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens.get('E2-1'.replace('-', '.'), '0.00') }}">
                    <p class="info">E2.1</p>
                </div>
                <div class="zona" id="E1-2" onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens.get('E1-2'.replace('-', '.'), '0.00') }}">
                    <p class="info">E1.2</p>
                </div>
                
                <div class="zona" id="E2-2-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('E2-2'.replace('-', '.'), '0.00') }}">
                    <p class="info">E2.2</p>
                </div>
                <div class="zona" id="E2-1-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('E2-1'.replace('-', '.'), '0.00') }}">
                    <p class="info">E2.1</p>
                </div>
                <div class="zona" id="E1-2-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('E1-2'.replace('-', '.'), '0.00') }}">
                    <p class="info">E1.2</p>
                </div>  
                <div class="zona" id="E3-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('E3'.replace('-', '.'), '0.00') }}">
                    <p class="info">E3</p>
                </div>
                <div class="zona" id="E1-1-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('E1-1'.replace('-', '.'), '0.00') }}">
                    <p class="info">E1.1</p>
                </div>
                <div class="zona" id="D1-1-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('D1-1'.replace('-', '.'), '0.00') }}">
                    <p class="info">D1.1</p>
                </div>
                <div class="zona" id="D3-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('D3'.replace('-', '.'), '0.00') }}">
                    <p class="info">D3</p>
                </div>
                <div class="zona" id="D2-2-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('D2-2'.replace('-', '.'), '0.00') }}">
                    <p class="info">D2.2</p>
                </div>
                <div class="zona" id="D2-1-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('D2-1'.replace('-', '.'), '0.00') }}">
                    <p class="info">D2.1</p>
                </div>
                <div class="zona" id="D1-2-D"onmouseover="showPercentage(this)" onmouseout="showName(this)"data-percentage="{{ porcentagens_bragan.get('D1-2'.replace('-', '.'), '0.00') }}">
                    <p class="info">D1.2</p>
                </div>
            </div>

            <div class="listas-jogadores-container">
                <div class="lista-jogadores-container sep">
                    <h3>Destaques SEP</h3>
                    <ul class="lista-jogadores">
                        <!-- jogadores em destaques -->
                        {% for jogador in destaques.pal %}
                        <li class="jogador-item">
                            <!-- <img src="{{ url_for('static', filename=jogador.imagem) }}" alt="{{ jogador.nome }}"> -->
                            <div class="jogador-info">
                                <h3>{{ jogador.nome_jogador }}</h3>
                                <p>{{ jogador.num_participacoes_em_cruzamentos }}</p>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>

                <div class="list-divider"></div> <!-- Linha divisória entre as listas -->

                <div class="lista-jogadores-container rbb">
                    <h3>Destaques RBB</h3>
                    <ul class="lista-jogadores">
                        {% for jogador in destaques.red %}
                        <li class="jogador-item">
                            <!-- <img src="{{ url_for('static', filename=jogador.imagem) }}" alt="{{ jogador.nome }}"> -->
                            <div class="jogador-info">
                                <h3>{{ jogador.nome_jogador }}</h3>
                                <p>{{ jogador.num_participacoes_em_cruzamentos }}</p>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            <style>
            .graficos {
                display: flex;
                flex: 1;
                width: 100%;
                height: fit-content;

              }
          
              .graficos-time-1, .graficos-time-2 {
                display: flex;
                flex-direction: column;
                flex: 1;
                padding: 20px;
                border: 1px solid #ccc;
                height: fit-content;
              }
              
          
            </style>
            <div class="graficos">
                <div class="graficos-time-1">
                    <div id="grafico-cruzamentos-1"></div>
                    <div id="grafico-desfechos-1"></div>
                </div>
                <div class="graficos-time-2">
                    <div id="grafico-cruzamentos-2"></div>
                    <div id="grafico-desfechos-2"></div>
                </div>
            </div>
        </div>
        <script type="text/javascript">

            google.charts.load('current', {'packages':['bar']});

            google.charts.setOnLoadCallback(drawChart);

            function drawChart() {
                let destaques = '{{ destaques }}';
                destaques = destaques.replaceAll("&#39;", '"');
                destaques = JSON.parse(destaques);

                let destaques_1 = destaques.pal;

                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Jogador');
                data.addColumn('number', 'Quantidade');

                for (let i = 0; i < destaques_1.length; i++) {
                    let item = destaques_1[i];
                    data.addRow([item.nome_jogador, item.num_participacoes_em_cruzamentos]);
                }

                var options = {
                    chart: {
                        title: 'Número de participações em cruzamentos',
                        subtitle: '',
                    },
                    bars: 'horizontal',
                    width: 400,
                    height: 350,
                    legend: { position: 'none' },
                };

                var chart = new google.charts.Bar(document.getElementById('grafico-cruzamentos-1'));
                chart.draw(data, google.charts.Bar.convertOptions(options));
            }

            google.charts.load('current', {'packages':['bar']});

            google.charts.setOnLoadCallback(drawChart2);

            function drawChart2() {
                let destaques = '{{ destaques }}';
                destaques = destaques.replaceAll("&#39;", '"');
                destaques = JSON.parse(destaques);

                let destaques_2 = destaques.red;

                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Jogador');
                data.addColumn('number', 'Quantidade');

                for (let i = 0; i < destaques_2.length; i++) {
                    let item = destaques_2[i];
                    data.addRow([item.nome_jogador, item.num_participacoes_em_cruzamentos]);
                }

                var options = {
                    chart: {
                        title: 'Número de participações em cruzamentos',
                        subtitle: '',
                    },
                    bars: 'horizontal',
                    width: 400,
                    height: 350,
                    legend: { position: 'none' },
                };

                var chart = new google.charts.Bar(document.getElementById('grafico-cruzamentos-2'));
                chart.draw(data, google.charts.Bar.convertOptions(options));
            }

            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart3);
            
            function drawChart3() {
                
                let desfechos = '{{ desfechos }}'
                desfechos = desfechos.replaceAll("&#39;", '"');
                desfechos =  JSON.parse(desfechos)

                let desfechosTime1 = desfechos.pal;

                // Transforma o dicionário em um array de arrays
                let data = [['Desfecho', 'Quantidade']];
                for (let desfecho in desfechosTime1) {
                    data.push([desfecho, desfechosTime1[desfecho]]);
                }

                var dataChart = google.visualization.arrayToDataTable(data);

                var options = {
                    title: 'Distribuição de Desfechos (pal)',
                    width: 400,
                    height: 350,
                };

                var chart = new google.visualization.PieChart(document.getElementById('grafico-desfechos-1'));
                chart.draw(dataChart, options);
            }

            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart4);
            
            function drawChart4() {
                
                let desfechos = '{{ desfechos }}'
                desfechos = desfechos.replaceAll("&#39;", '"');
                desfechos =  JSON.parse(desfechos)

                let desfechosTime1 = desfechos.red;

                // Transforma o dicionário em um array de arrays
                let data = [['Desfecho', 'Quantidade']];
                for (let desfecho in desfechosTime1) {
                    data.push([desfecho, desfechosTime1[desfecho]]);
                }

                var dataChart = google.visualization.arrayToDataTable(data);

                var options = {
                    title: 'Distribuição de Desfechos (pal)',
                    width: 400,
                    height: 350,
                };

                var chart = new google.visualization.PieChart(document.getElementById('grafico-desfechos-2'));
                chart.draw(dataChart, options);
            }

        </script>
        <div class="divider"></div>

            <div class="right-container">
                    <h2>Lances</h2>
                    <h3>Lista de cruzamento</h3>
                    <h4>Selecione um lance para visualizar</p>
                <div class="scroll-list-container">
                    <ul id="cruzamentos-list">
                        {% for cruzamento in cruzamentos %}
                        <li onclick="seekToTime('{{ cruzamento['instante_inicial'] | convert_to_seconds }}', '{{ cruzamento['nome_jogadores_time_cruzando'] }}', '{{ cruzamento['nome_jogadores_time_defendendo'] }}')">
                            Cruzamento #{{ loop.index }} - {{ cruzamento['instante_inicial'] }} - {{ cruzamento['desfecho'] }} - Zona {{ cruzamento['zona'] }}
                        </li>                
                        {% endfor %}
                    </ul>
                </div>
                <video id="myVideo" width="630" height="480" controls>
                    <source src="static/video/Jogo_Palmeiras_x_Bragantino.mp4" type="video/mp4">
                    Seu navegador não suporta vídeos HTML5.
                </video>
                <br>
                <div class="video-controls">
                    <button id="retroceder5" class="video-btn" onclick="retroceder(5)">◀ 5s</button>
                    <button id="retroceder1" class="video-btn" onclick="retroceder(1)">◀ 1s</button>
                    <button id="playPause" class="video-btn" onclick="playPause()">▶/⏸</button>
                    <button id="avançar5" class="video-btn" onclick="avançar(5)">5s ▶</button>
                    <button id="avançar1" class="video-btn" onclick="avançar(1)">1s ▶</button>
                </div>

                <div class="player-list-container">
                    <div class="jogadores-atacando">
                        <h3>Jogadores Atacando</h3>
                        <ul id="jogadores-atacando-list"></ul>
                    </div>
                    
                    <div class="list-divider"></div> <!-- Linha divisória entre as listas -->
                
                    <div class="jogadores-defendendo">
                        <h3>Jogadores Defendendo</h3>
                        <ul id="jogadores-defendendo-list"></ul>
                    </div>
                </div>
                <br><br>
        
                <script src="{{ url_for('static', filename='js/video.js') }}"></script>
                
            </div>
        </div>
  </body>
  </html>

