{% include 'header.html' %}


<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delta Goal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/quebras_de_linha.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='img/delta_goal_logo.png') }}">
</head>
<body>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    
    
    async function drawChart() {
        
        var response = await fetch("http://localhost:5000/palmeiras_desfechos")
        response = await response.json()
        
        let dados = response
        console.log(dados)
        let keys = Object.keys(dados)
        const list = [["Desfecho", "Rupturas"]]
        
        for (let i = 0; i < keys.length; i++) {
            list.push([String(keys[i]),    dados[keys[i]]])
        }
        var data = google.visualization.arrayToDataTable(list);
        var options = {
            title: 'Desfechos'
        };
        
        var chart = new google.visualization.PieChart(document.getElementById('piechart'));
        
        
        chart.draw(data, options);
        
    }
    
    window.onload = drawChart()
    
  </script>


    <div class="left-container">
        <h3>Visão Geral</h3>
        <h4>Permanência nas sub-zonas</h4>
        <div class="campo-futebol">
        <img src="static/img/campo.png" alt="Campo de Futebol">
        

            <div class="zona" id="M2" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagem_quebra.get('Zona 2', 0) | round(2) }}">
                <p class="info nome-zona">2</p>
                <p class="info porcentagem-zona" style="display:none;">{{ porcentagem_quebra.get('Zona 2', 0) | round(2) }}%</p>
            </div>
            <div class="zona" id="B1" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagem_quebra.get('Zona 1 - B', 0) | round(2) }}">
                <p class="info nome-zona">1.B</p>
                <p class="info porcentagem-zona" style="display:none;">{{ porcentagem_quebra.get('Zona 1 - B', 0) | round(2) }}%</p>
            </div>
            <div class="zona" id="A1" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagem_quebra.get('Zona 1 - A', 0) | round(2) }}">
                <p class="info nome-zona">1.A</p>
                <p class="info porcentagem-zona" style="display:none;">{{ porcentagem_quebra.get('Zona 1 - A', 0) | round(2) }}%</p>
            </div>
            <div class="zona" id="B3" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagem_quebra.get('Zona 3 - B', 0) | round(2) }}">
                <p class="info nome-zona">3.B</p>
                <p class="info porcentagem-zona" style="display:none;">{{ porcentagem_quebra.get('Zona 3 - B', 0) | round(2) }}%</p>
            </div>
            <div class="zona" id="A3" onmouseover="showPercentage(this)" onmouseout="showName(this)" data-percentage="{{ porcentagem_quebra.get('Zona 3 - A', 0) | round(2) }}">
                <p class="info nome-zona">3.A</p>
                <p class="info porcentagem-zona" style="display:none;">{{ porcentagem_quebra.get('Zona 3 - A', 0) | round(2) }}%</p>
            </div>
        </div>
        <div class="listas-jogadores-container">
            <div class="lista-jogadores-container sep">
                <h3>Destaques SEP</h3>
                <ul class="lista-jogadores">
                    <!-- jogadores em destaques -->
                    {% for jogador in destaques.pal %}
                    <li class="jogador-item">
                        <!-- <img src="{{ url_for('static', filename=jogador.imagem) }}" alt="{{ jogador.nome }}"> -->
                        <div class="jogador-info">
                            <h3>{{ jogador.nome_jogador }}</h3>
                            <p>{{ jogador.num_participacoes_em_cruzamentos }}</p>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>

            <div id="piechart" style="width: 500px; height: 400px; margin: 50px; color:black;"></div>
                
            </div>
        </div>



        <div class="right-container">
            <h2>Lances</h2>
            <h3>Lista de quebras</h3>
            <h4>Selecione um lance para visualizar</h4>
            <div class="scroll-list-container">
                <ul id="cruzamentos-list">
                    <h4>Palmeiras:</h4>
                    {% for quebra in quebras %}
                    <li onclick="seekToTime('{{ quebra['inicio_ruptura'] | convert_to_seconds }}')">
                        Quebra #{{ loop.index }} - {{ quebra['instante_inicial'] }} - {{ quebra['desfecho'] }} - Zona {{ quebra['zona_defesa'] }}
                    </li>
                    {% endfor %}
                    <!-- Repita para Bragantino -->
                </ul>
            </div>
        </div>     
        <video id="myVideo" width="630" height="480" controls>
            <source src="static/video/Jogo_Palmeiras_x_Bragantino.mp4" type="video/mp4">
            Seu navegador não suporta vídeos HTML5.
        </video>
        <br>
        <div class="video-controls">
            <button id="retroceder5" class="video-btn" onclick="retroceder(5)">◀ 5s</button>
            <button id="retroceder1" class="video-btn" onclick="retroceder(1)">◀ 1s</button>
            <button id="playPause" class="video-btn" onclick="playPause()">▶/⏸</button>
            <button id="avançar5" class="video-btn" onclick="avançar(5)">5s ▶</button>
            <button id="avançar1" class="video-btn" onclick="avançar(1)">1s ▶</button>
        </div>
    </div>
    <!-- Script para Controle do Vídeo -->
    <script>
        function seekToTime(seconds) {
            var video = document.getElementById('myVideo');
            if (video) {
                video.currentTime = parseInt(seconds, 10);
            }
        }

        function retroceder(segundos) {
            var video = document.getElementById("myVideo");
            if (video) {
                video.currentTime = Math.max(video.currentTime - segundos, 0);
            }
        }

        function avançar(segundos) {
            var video = document.getElementById("myVideo");
            if (video) {
                video.currentTime = Math.min(video.currentTime + segundos, video.duration);
            }
        }

        function playPause() {
            var video = document.getElementById("myVideo");
            if (video) {
                if (video.paused) {
                    video.play();
                } else {
                    video.pause();
                }
            }
        }
    </script>
    <script>
        function showPercentage(zoneElement) {
            zoneElement.querySelector('.nome-zona').style.display = 'none';
            zoneElement.querySelector('.porcentagem-zona').style.display = 'block';
        }
    
        function showName(zoneElement) {
            zoneElement.querySelector('.nome-zona').style.display = 'block';
            zoneElement.querySelector('.porcentagem-zona').style.display = 'none';
        }
    </script>
    <!-- <script>
        function seekToTime(seconds, jogadoresEnv, jogadoresDef) {
        var video = document.getElementById('myVideo');
        video.currentTime = seconds;

        // Atualiza a lista de jogadores atacando
        var listaAtacando = document.getElementById('jogadores-atacando-list');
        listaAtacando.innerHTML = ''; // Limpa a lista atual
        jogadoresEnv.split(',').forEach(function(jogador) {
            var li = document.createElement('li');
            li.textContent = jogador.trim();
            listaAtacando.appendChild(li);
        });

        // Atualiza a lista de jogadores defendendo
        var listaDefendendo = document.getElementById('jogadores-defendendo-list');
        listaDefendendo.innerHTML = ''; // Limpa a lista atual
        jogadoresDef.split(',').forEach(function(jogador) {
            var li = document.createElement('li');
            li.textContent = jogador.trim();
            listaDefendendo.appendChild(li);
        });
    }




    function showPercentage(element) {
        // Salva o nome original da zona se ainda não foi salvo
        if (!element.dataset.originalName) {
            element.dataset.originalName = element.querySelector('.info').textContent;
        }
        // Define a porcentagem (isso deve ser ajustado para cada zona, se for diferente)
        element.querySelector('.info').textContent = element.dataset.percentage || '25%';
    }

    function showName(element) {
        // Retorna ao nome original da zona
        element.querySelector('.info').textContent = element.dataset.originalName;
    }

    function retroceder(segundos) {
        var video = document.getElementById("myVideo");
        video.currentTime -= segundos;
    }

    function avançar(segundos) {
        var video = document.getElementById("myVideo");
        video.currentTime += segundos;
    }

    function playPause() {
        var video = document.getElementById("myVideo");
        if (video.paused) {
            video.play();
        } else {
            video.pause();
        }
    }

    </script>
     -->
  </body>
</html>